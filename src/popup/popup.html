<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One-Click Outreach</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>One-Click Outreach</h1>
            <button id="optionsBtn" class="options-btn" title="Settings">⚙️</button>
        </header>

        <!-- Status/Loading -->
        <div id="loadingSection" class="section loading-section">
            <div class="loading-spinner"></div>
            <p>Extracting page content...</p>
        </div>

        <!-- Error State -->
        <div id="errorSection" class="section error-section hidden">
            <div class="error-icon">⚠️</div>
            <p id="errorMessage">Unable to extract content from this page.</p>
            <button id="retryBtn" class="btn btn-secondary">Try Again</button>
        </div>

        <!-- Main Content -->
        <div id="mainSection" class="section main-section hidden">
            <!-- Extracted Content Preview -->
            <div class="content-preview">
                <h3>Extracted Content</h3>
                <div id="contentPreview" class="preview-text">
                    Content will appear here...
                </div>
                <div class="source-info">
                    <span id="sourceType" class="source-badge">LinkedIn</span>
                </div>
            </div>

            <!-- CRM Integration Section -->
            <div class="crm-section">
                <!-- Identity Input -->
                <div class="identity-section">
                    <h4>Contact Identity</h4>
                    <div class="identity-grid">
                        <div class="input-group">
                            <label for="firstName" class="label">First Name</label>
                            <input type="text" id="firstName" class="input" placeholder="Auto-detected">
                        </div>
                        <div class="input-group">
                            <label for="lastName" class="label">Last Name</label>
                            <input type="text" id="lastName" class="input" placeholder="Auto-detected">
                        </div>
                        <div class="input-group full-width">
                            <label for="contactEmail" class="label">Email</label>
                            <input type="email" id="contactEmail" class="input" placeholder="Auto-detected from page">
                        </div>
                        <div class="input-group">
                            <label for="contactCompanyInput" class="label">Company</label>
                            <input type="text" id="contactCompanyInput" class="input" placeholder="Auto-detected">
                        </div>
                        <div class="input-group">
                            <label for="contactTitleInput" class="label">Title</label>
                            <input type="text" id="contactTitleInput" class="input" placeholder="Auto-detected">
                        </div>
                        <div class="input-group">
                            <label for="contactPhone" class="label">Phone</label>
                            <input type="tel" id="contactPhone" class="input" placeholder="Optional">
                        </div>
                        <div class="input-group full-width">
                            <label for="contactLinkedIn" class="label">LinkedIn URL</label>
                            <input type="url" id="contactLinkedIn" class="input" placeholder="https://linkedin.com/in/username">
                        </div>
                        <div class="input-group full-width">
                            <label for="contactNotes" class="label">Notes</label>
                            <textarea id="contactNotes" class="input" rows="2" placeholder="Add any notes about this contact..."></textarea>
                        </div>
                    </div>
                    <button id="checkCrmBtn" class="btn btn-secondary btn-small">
                        <span class="btn-text">Check CRM</span>
                        <div class="btn-spinner hidden"></div>
                    </button>
                </div>

                <!-- CRM Status Display -->
                <div id="crmStatus" class="crm-status hidden">
                    <div class="status-header">
                        <span id="crmStatusIcon" class="status-icon">⏳</span>
                        <span id="crmStatusText" class="status-text">Checking CRM...</span>
                    </div>
                    <div id="crmStatusDetails" class="status-details"></div>
                </div>

                <!-- Contact Information Panel -->
                <div id="contactPanel" class="contact-panel hidden">
                    <div class="panel-header">
                        <h4>Contact Found in CRM</h4>
                        <div class="panel-actions">
                            <button id="editContactBtn" class="btn btn-link btn-small">Edit</button>
                            <button id="createDuplicateContactBtn" class="btn btn-secondary btn-small">Create New</button>
                        </div>
                    </div>
                    <div class="contact-info">
                        <div class="contact-details">
                            <div class="detail-row">
                                <span class="detail-label">Name:</span>
                                <span id="contactName" class="detail-value">-</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Email:</span>
                                <span id="contactEmailDisplay" class="detail-value">-</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Company:</span>
                                <span id="contactCompany" class="detail-value">-</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Title:</span>
                                <span id="contactTitle" class="detail-value">-</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Projects Panel -->
                    <div id="projectsPanel" class="projects-panel hidden">
                        <h5>Associated Projects</h5>
                        <div id="projectsList" class="projects-list">
                            <!-- Projects will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Create Contact Panel -->
                <div id="createContactPanel" class="create-contact-panel hidden">
                    <div class="panel-header">
                        <h4>Contact Not Found</h4>
                        <button id="createContactBtn" class="btn btn-secondary btn-small">Create in CRM</button>
                    </div>
                    <p class="panel-message">This contact doesn't exist in your CRM. You can create them automatically or proceed without CRM integration.</p>
                </div>
            </div>

            <!-- Email Generation Toggle -->
            <div class="email-generation-section">
                <div class="section-toggle">
                    <button id="emailToggleBtn" class="toggle-btn">
                        <span class="toggle-icon">▶</span>
                        <span class="toggle-text">Generate Outreach Email</span>
                    </button>
                </div>

                <!-- Collapsible Email Generation Content -->
                <div id="emailGenerationContent" class="email-content hidden">
                    <!-- Template Selection -->
                    <div class="template-section">
                        <label for="templateSelect" class="label">Email Template</label>
                        <select id="templateSelect" class="template-select">
                            <option value="">Loading templates...</option>
                        </select>
                        <div class="template-info">
                            <span id="templateDescription" class="template-description"></span>
                        </div>
                    </div>

                    <!-- Message Intent -->
                    <div class="intent-section">
                        <label for="messageIntent" class="label">What kind of message do you want to send?</label>
                        <textarea 
                            id="messageIntent" 
                            class="intent-input" 
                            placeholder="e.g., Introductory note, ask for 15-minute call"
                            rows="2"
                            maxlength="200"
                        ></textarea>
                        <div class="char-count">
                            <span id="charCount">0</span>/200
                        </div>
                    </div>

                    <!-- Style Rules -->
            <div class="rules-section">
                <h4>Style Rules</h4>
                <div class="rules-grid">
                    <label class="checkbox-label">
                        <input type="checkbox" id="maxSentences" checked>
                        <span class="checkmark"></span>
                        Max 6 sentences
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="maxParagraphs" checked>
                        <span class="checkmark"></span>
                        1-2 paragraphs
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="noEmDashes" checked>
                        <span class="checkmark"></span>
                        No em dashes
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="includeCalendar">
                        <span class="checkmark"></span>
                        Include calendar link
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="includeBio">
                        <span class="checkmark"></span>
                        Include bio
                    </label>
                </div>
            </div>

                    <!-- Generate Button -->
                    <button id="generateBtn" class="btn btn-primary">
                        <span class="btn-text">Generate Email</span>
                        <div class="btn-spinner hidden"></div>
                    </button>
                </div> <!-- End of email generation content -->
            </div> <!-- End of email generation section -->
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="section results-section hidden">
            <div class="results-header">
                <h3>Generated Email</h3>
                <button id="backBtn" class="btn btn-secondary btn-small">← Back</button>
            </div>

            <!-- Subject Line -->
            <div class="result-group">
                <label class="result-label">Subject Line</label>
                <div id="subjectLine" class="result-content"></div>
            </div>

            <!-- Email Body -->
            <div class="result-group">
                <label class="result-label">Email Body</label>
                <div id="emailBody" class="result-content"></div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button id="copyBtn" class="btn btn-primary">
                    <span class="btn-text">Copy to Clipboard</span>
                    <span class="btn-success hidden">✓ Copied!</span>
                </button>
                <button id="regenerateBtn" class="btn btn-secondary">Generate New</button>
            </div>

            <!-- Stats -->
            <div class="stats">
                <span class="stat">
                    <span id="sentenceCount">0</span> sentences
                </span>
                <span class="stat">
                    <span id="paragraphCount">0</span> paragraphs
                </span>
                <span class="stat">
                    <span id="wordCount">0</span> words
                </span>
            </div>
        </div>

        <!-- Configuration Warning -->
        <div id="configSection" class="section config-section hidden">
            <div class="config-icon">⚙️</div>
            <h3>Setup Required</h3>
            <p>Please configure your API key and settings before generating emails.</p>
            <button id="openOptionsBtn" class="btn btn-primary">Open Settings</button>
        </div>
    </div>

    <script src="popup.js"></script>
</body>
</html>